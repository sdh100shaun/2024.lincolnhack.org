"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const cdk = require("aws-cdk-lib");
const aws_cdk_github_oidc_1 = require("aws-cdk-github-oidc");
const iam = require("aws-cdk-lib/aws-iam");
class OidcConnection extends cdk.Stack {
    constructor(construct, name, props) {
        super(construct, name);
        const provider = new aws_cdk_github_oidc_1.GithubActionsIdentityProvider(this, "GithubProvider");
        const deployRole = new aws_cdk_github_oidc_1.GithubActionsRole(this, "DeployRole", {
            provider: provider,
            owner: props.repositoryConfig.owner,
            repo: props.repositoryConfig.repo,
            filter: props.repositoryConfig.filter,
            roleName: "LincolnHack2024DeployRole",
            description: "This role deploys stuff to AWS",
            maxSessionDuration: cdk.Duration.hours(2),
        });
        deployRole.addManagedPolicy(iam.ManagedPolicy.fromAwsManagedPolicyName("AdministratorAccess"));
    }
}
exports.default = OidcConnection;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLG1DQUFtQztBQUVuQyw2REFBdUY7QUFDdkYsMkNBQTJDO0FBVzNDLE1BQXFCLGNBQWUsU0FBUSxHQUFHLENBQUMsS0FBSztJQUVyRCxZQUFZLFNBQW9CLEVBQUUsSUFBWSxFQUFFLEtBQW9CO1FBRWhFLEtBQUssQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFFdkIsTUFBTSxRQUFRLEdBQUcsSUFBSSxtREFBNkIsQ0FBQyxJQUFJLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQztRQUUzRSxNQUFNLFVBQVUsR0FBRyxJQUFJLHVDQUFpQixDQUFDLElBQUksRUFBRSxZQUFZLEVBQUU7WUFDekQsUUFBUSxFQUFFLFFBQVE7WUFDbEIsS0FBSyxFQUFFLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLO1lBQ25DLElBQUksRUFBRSxLQUFLLENBQUMsZ0JBQWdCLENBQUMsSUFBSTtZQUNqQyxNQUFNLEVBQUUsS0FBSyxDQUFDLGdCQUFnQixDQUFDLE1BQU07WUFDckMsUUFBUSxFQUFFLDJCQUEyQjtZQUNyQyxXQUFXLEVBQUUsZ0NBQWdDO1lBQzdDLGtCQUFrQixFQUFFLEdBQUcsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztTQUM1QyxDQUFDLENBQUM7UUFFSCxVQUFVLENBQUMsZ0JBQWdCLENBQ3ZCLEdBQUcsQ0FBQyxhQUFhLENBQUMsd0JBQXdCLENBQUMscUJBQXFCLENBQUMsQ0FDaEUsQ0FBQztJQUNOLENBQUM7Q0FDSjtBQXRCRCxpQ0FzQkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBjZGsgZnJvbSAnYXdzLWNkay1saWInO1xuaW1wb3J0IHsgQ29uc3RydWN0IH0gZnJvbSAnY29uc3RydWN0cyc7XG5pbXBvcnQgeyBHaXRodWJBY3Rpb25zSWRlbnRpdHlQcm92aWRlciwgR2l0aHViQWN0aW9uc1JvbGUgfSBmcm9tIFwiYXdzLWNkay1naXRodWItb2lkY1wiO1xuaW1wb3J0ICogYXMgaWFtIGZyb20gJ2F3cy1jZGstbGliL2F3cy1pYW0nOyBcblxuZXhwb3J0IGludGVyZmFjZSBPSURDUm9sZVByb3BzIGV4dGVuZHMgY2RrLlN0YWNrUHJvcHN7XG4gIG9pZGNQcm92aWRlclVybDogc3RyaW5nO1xuICBjbGllbnRJZHM6IHN0cmluZ1tdO1xuICB0aHVtYnByaW50czogc3RyaW5nW107XG4gIHJlYWRvbmx5IHJlcG9zaXRvcnlDb25maWc6IHsgb3duZXI6IHN0cmluZzsgcmVwbzogc3RyaW5nOyBmaWx0ZXI/OiBzdHJpbmcgfTtcbn1cbiAgXG4gXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE9pZGNDb25uZWN0aW9uIGV4dGVuZHMgY2RrLlN0YWNrIHtcblxuY29uc3RydWN0b3IoY29uc3RydWN0OiBDb25zdHJ1Y3QsIG5hbWU6IHN0cmluZywgcHJvcHM6IE9JRENSb2xlUHJvcHMpIHtcbiAgICBcbiAgICBzdXBlcihjb25zdHJ1Y3QsIG5hbWUpO1xuXG4gICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgR2l0aHViQWN0aW9uc0lkZW50aXR5UHJvdmlkZXIodGhpcywgXCJHaXRodWJQcm92aWRlclwiKTtcbiAgIFxuICAgIGNvbnN0IGRlcGxveVJvbGUgPSBuZXcgR2l0aHViQWN0aW9uc1JvbGUodGhpcywgXCJEZXBsb3lSb2xlXCIsIHtcbiAgICAgICAgcHJvdmlkZXI6IHByb3ZpZGVyLFxuICAgICAgICBvd25lcjogcHJvcHMucmVwb3NpdG9yeUNvbmZpZy5vd25lcixcbiAgICAgICAgcmVwbzogcHJvcHMucmVwb3NpdG9yeUNvbmZpZy5yZXBvLFxuICAgICAgICBmaWx0ZXI6IHByb3BzLnJlcG9zaXRvcnlDb25maWcuZmlsdGVyLFxuICAgICAgICByb2xlTmFtZTogXCJMaW5jb2xuSGFjazIwMjREZXBsb3lSb2xlXCIsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoaXMgcm9sZSBkZXBsb3lzIHN0dWZmIHRvIEFXU1wiLFxuICAgICAgICBtYXhTZXNzaW9uRHVyYXRpb246IGNkay5EdXJhdGlvbi5ob3VycygyKSxcbiAgICB9KTtcblxuICAgIGRlcGxveVJvbGUuYWRkTWFuYWdlZFBvbGljeShcbiAgICAgICAgaWFtLk1hbmFnZWRQb2xpY3kuZnJvbUF3c01hbmFnZWRQb2xpY3lOYW1lKFwiQWRtaW5pc3RyYXRvckFjY2Vzc1wiKVxuICAgICAgICApO1xuICAgIH1cbn1cbiJdfQ==