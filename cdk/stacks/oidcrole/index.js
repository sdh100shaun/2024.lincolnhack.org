"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const cdk = require("aws-cdk-lib");
const aws_cdk_github_oidc_1 = require("aws-cdk-github-oidc");
const iam = require("aws-cdk-lib/aws-iam");
class OidcConnection extends cdk.Stack {
    constructor(construct, name, props) {
        super(construct, name);
        const provider = new aws_cdk_github_oidc_1.GithubActionsIdentityProvider(this, "GithubProvider");
        const deployRole = new aws_cdk_github_oidc_1.GithubActionsRole(this, "DeployRole", {
            provider: provider,
            owner: props.repositoryConfig[0].owner,
            repo: props.repositoryConfig[0].repo,
            filter: props.repositoryConfig[0].filter,
            roleName: "LincolnHack2024DeployRole",
            description: "This role deploys stuff to AWS",
            maxSessionDuration: cdk.Duration.hours(2),
        });
        deployRole.addManagedPolicy(iam.ManagedPolicy.fromAwsManagedPolicyName("AdministratorAccess"));
    }
}
exports.default = OidcConnection;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLG1DQUFtQztBQUVuQyw2REFBdUY7QUFDdkYsMkNBQTJDO0FBVzNDLE1BQU0sY0FBZSxTQUFRLEdBQUcsQ0FBQyxLQUFLO0lBRXRDLFlBQVksU0FBb0IsRUFBRSxJQUFZLEVBQUUsS0FBb0I7UUFFaEUsS0FBSyxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUV2QixNQUFNLFFBQVEsR0FBRyxJQUFJLG1EQUE2QixDQUFDLElBQUksRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDO1FBSTNFLE1BQU0sVUFBVSxHQUFHLElBQUksdUNBQWlCLENBQUMsSUFBSSxFQUFFLFlBQVksRUFBRTtZQUN6RCxRQUFRLEVBQUUsUUFBUTtZQUNsQixLQUFLLEVBQUUsS0FBSyxDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUs7WUFDdEMsSUFBSSxFQUFFLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJO1lBQ3BDLE1BQU0sRUFBRSxLQUFLLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTTtZQUN4QyxRQUFRLEVBQUUsMkJBQTJCO1lBQ3JDLFdBQVcsRUFBRSxnQ0FBZ0M7WUFDN0Msa0JBQWtCLEVBQUUsR0FBRyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1NBQzVDLENBQUMsQ0FBQztRQUVILFVBQVUsQ0FBQyxnQkFBZ0IsQ0FDdkIsR0FBRyxDQUFDLGFBQWEsQ0FBQyx3QkFBd0IsQ0FBQyxxQkFBcUIsQ0FBQyxDQUNwRSxDQUFDO0lBQ0UsQ0FBQztDQUVKO0FBQ0wsa0JBQWUsY0FBYyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgY2RrIGZyb20gJ2F3cy1jZGstbGliJztcbmltcG9ydCB7IENvbnN0cnVjdCB9IGZyb20gJ2NvbnN0cnVjdHMnO1xuaW1wb3J0IHsgR2l0aHViQWN0aW9uc0lkZW50aXR5UHJvdmlkZXIsIEdpdGh1YkFjdGlvbnNSb2xlIH0gZnJvbSBcImF3cy1jZGstZ2l0aHViLW9pZGNcIjtcbmltcG9ydCAqIGFzIGlhbSBmcm9tICdhd3MtY2RrLWxpYi9hd3MtaWFtJzsgXG5cbmV4cG9ydCBpbnRlcmZhY2UgT0lEQ1JvbGVQcm9wcyBleHRlbmRzIGNkay5TdGFja1Byb3Bze1xuICBvaWRjUHJvdmlkZXJVcmw6IHN0cmluZztcbiAgY2xpZW50SWRzOiBzdHJpbmdbXTtcbiAgdGh1bWJwcmludHM6IHN0cmluZ1tdO1xuICByZWFkb25seSByZXBvc2l0b3J5Q29uZmlnOiB7IG93bmVyOiBzdHJpbmc7IHJlcG86IHN0cmluZzsgZmlsdGVyPzogc3RyaW5nIH1bXTtcbn1cbiAgXG5cblxuY2xhc3MgT2lkY0Nvbm5lY3Rpb24gZXh0ZW5kcyBjZGsuU3RhY2sge1xuXG5jb25zdHJ1Y3Rvcihjb25zdHJ1Y3Q6IENvbnN0cnVjdCwgbmFtZTogc3RyaW5nLCBwcm9wczogT0lEQ1JvbGVQcm9wcykge1xuICAgIFxuICAgIHN1cGVyKGNvbnN0cnVjdCwgbmFtZSk7XG5cbiAgICBjb25zdCBwcm92aWRlciA9IG5ldyBHaXRodWJBY3Rpb25zSWRlbnRpdHlQcm92aWRlcih0aGlzLCBcIkdpdGh1YlByb3ZpZGVyXCIpO1xuICAgXG4gICAgXG4gICAgXG4gICAgY29uc3QgZGVwbG95Um9sZSA9IG5ldyBHaXRodWJBY3Rpb25zUm9sZSh0aGlzLCBcIkRlcGxveVJvbGVcIiwge1xuICAgICAgICBwcm92aWRlcjogcHJvdmlkZXIsXG4gICAgICAgIG93bmVyOiBwcm9wcy5yZXBvc2l0b3J5Q29uZmlnWzBdLm93bmVyLFxuICAgICAgICByZXBvOiBwcm9wcy5yZXBvc2l0b3J5Q29uZmlnWzBdLnJlcG8sXG4gICAgICAgIGZpbHRlcjogcHJvcHMucmVwb3NpdG9yeUNvbmZpZ1swXS5maWx0ZXIsXG4gICAgICAgIHJvbGVOYW1lOiBcIkxpbmNvbG5IYWNrMjAyNERlcGxveVJvbGVcIixcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhpcyByb2xlIGRlcGxveXMgc3R1ZmYgdG8gQVdTXCIsXG4gICAgICAgIG1heFNlc3Npb25EdXJhdGlvbjogY2RrLkR1cmF0aW9uLmhvdXJzKDIpLFxuICAgIH0pO1xuXG4gICAgZGVwbG95Um9sZS5hZGRNYW5hZ2VkUG9saWN5KFxuICAgICAgICBpYW0uTWFuYWdlZFBvbGljeS5mcm9tQXdzTWFuYWdlZFBvbGljeU5hbWUoXCJBZG1pbmlzdHJhdG9yQWNjZXNzXCIpXG4gICAgKTtcbiAgICAgICAgfSAgIFxuICAgIFxuICAgIH1cbmV4cG9ydCBkZWZhdWx0IE9pZGNDb25uZWN0aW9uO1xuIl19